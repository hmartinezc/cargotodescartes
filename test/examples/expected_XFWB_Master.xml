<?xml version="1.0" encoding="UTF-8"?>
<!--
  EJEMPLO DE REFERENCIA: XFWB Master (AWB con Houses)
  TypeCode: 741 = Master Air Waybill (Consolidation)
  
  Basado en el estándar IATA Cargo-XML 3.0
  Referencia: riege/one-record-converter
  
  Este archivo sirve como referencia visual para validar
  la estructura del XML generado por DescartesXmlService
  cuando el AWB tiene houses (consolidación)
  
  DIFERENCIAS CLAVE con Direct AWB:
  - TypeCode: 741 (no 740)
  - ContentCode: C (no M) en IncludedHeaderNote
  - ConsolidationIndicator: true
  - ConsignmentItemQuantity: número de houses
  - NilCarriageValueIndicator: true (NVD típico en consolidados)
-->
<iata:XFWB xmlns:iata="iata:waybill:1" xmlns:ram="urn:un:unece:uncefact:data:standard:ReusableAggregateBusinessInformationEntity:21" xmlns:udt="urn:un:unece:uncefact:data:standard:UnqualifiedDataType:25">

  <!-- Message Header -->
  <MessageHeaderDocument>
    <ID>MSG-180-99999999-CONSOL</ID>
    <Name>XFWB</Name>
    <!-- 741 = Master AWB (con houses / consolidación) -->
    <TypeCode>741</TypeCode>
    <IssueDateTime>2021-03-10T10:00:00Z</IssueDateTime>
    <PurposeCode>Creation</PurposeCode>
    <VersionID>3.00</VersionID>
  </MessageHeaderDocument>

  <!-- Business Header -->
  <BusinessHeaderDocument>
    <ID>180-99999999</ID>
    <IncludedHeaderNote>
      <!-- C = Consolidation (tiene houses) -->
      <ContentCode>C</ContentCode>
    </IncludedHeaderNote>
    <SenderParty>
      <PrimaryID schemeID="IATA-PIMA">REUFFW90AVTOPF/BOG01</PrimaryID>
    </SenderParty>
    <RecipientParty>
      <PrimaryID schemeID="IATA-PIMA">USCAIR01LUXXSXS</PrimaryID>
    </RecipientParty>
  </BusinessHeaderDocument>

  <!-- Master Consignment (AWB Content) -->
  <MasterConsignment>
    <TransportContractDocument>
      <ID>180-99999999</ID>
    </TransportContractDocument>
    <ID>99999999</ID>
    <TotalPieceQuantity>3</TotalPieceQuantity>
    
    <!-- INDICADORES DE CONSOLIDACIÓN (CRÍTICO) -->
    <!-- Esto marca el AWB como Master con houses -->
    <ConsolidationIndicator>true</ConsolidationIndicator>
    <ConsignmentItemQuantity>2</ConsignmentItemQuantity>
    <NilCarriageValueIndicator>true</NilCarriageValueIndicator>
    <NilCustomsValueIndicator>true</NilCustomsValueIndicator>
    
    <IncludedTareGrossWeightMeasure unitCode="KGM">1042</IncludedTareGrossWeightMeasure>
    <TotalGrossWeightMeasure unitCode="KGM">1042</TotalGrossWeightMeasure>
    <GrossVolumeMeasure unitCode="MTQ">2.602</GrossVolumeMeasure>
    <TotalChargeableWeightMeasure unitCode="KGM">1042</TotalChargeableWeightMeasure>
    
    <!-- Origin / Destination -->
    <OriginLocation>
      <ID>ORK</ID>
      <Name>Cork Airport</Name>
    </OriginLocation>
    <FinalDestinationLocation>
      <ID>PVG</ID>
      <Name>Shanghai Pudong</Name>
    </FinalDestinationLocation>
    
    <!-- Payment Terms -->
    <ApplicableFreightPayment>
      <MethodCode>PP</MethodCode>
    </ApplicableFreightPayment>
    
    <!-- Shipper (ConsignorParty) - Consolidator/Forwarder como shipper -->
    <ConsignorParty>
      <Name>SHIPPER COMPANY IRELAND</Name>
      <DefinedTradeContact>
        <DirectTelephoneCommunication>
          <CompleteNumber>353123456789</CompleteNumber>
        </DirectTelephoneCommunication>
      </DefinedTradeContact>
      <PostalStructuredAddress>
        <PostcodeCode>ABCD</PostcodeCode>
        <StreetName>Harbour Point Business Park</StreetName>
        <CityName>LITTLE CITY</CityName>
        <CountryID>IE</CountryID>
      </PostalStructuredAddress>
    </ConsignorParty>
    
    <!-- Consignee (ConsigneeParty) - Typically destination forwarder -->
    <ConsigneeParty>
      <Name>FORWARDER COMPANY SHANGHAI LTD</Name>
      <DefinedTradeContact>
        <DirectTelephoneCommunication>
          <CompleteNumber>862123454321</CompleteNumber>
        </DirectTelephoneCommunication>
      </DefinedTradeContact>
      <PostalStructuredAddress>
        <StreetName>SUHANG RD PUDONG AIRPORT</StreetName>
        <CityName>SHANGHAI</CityName>
        <CountryID>CN</CountryID>
      </PostalStructuredAddress>
    </ConsigneeParty>
    
    <!-- Freight Forwarder / Agent -->
    <FreightForwarderParty>
      <Name>FORWARDER COMPANY IRELAND LIMITED</Name>
      <CargoAgentID>3456789</CargoAgentID>
      <FreightForwarderAddress>
        <CityName>Little City</CityName>
      </FreightForwarderAddress>
    </FreightForwarderParty>
    
    <!-- Flights / Transport Movements -->
    <SpecifiedLogisticsTransportMovement>
      <StageCode>Main-Carriage</StageCode>
      <ModeCode>4</ModeCode>
      <ID>XX8012</ID>
      <SequenceNumeric>1</SequenceNumeric>
      <DepartureEvent>
        <ScheduledOccurrenceDateTime>2021-03-10</ScheduledOccurrenceDateTime>
        <OccurrenceArrivalLocation>
          <ID>ORK</ID>
          <Name>Cork</Name>
        </OccurrenceArrivalLocation>
      </DepartureEvent>
      <ArrivalEvent>
        <OccurrenceArrivalLocation>
          <ID>DUB</ID>
          <Name>Dublin</Name>
        </OccurrenceArrivalLocation>
      </ArrivalEvent>
    </SpecifiedLogisticsTransportMovement>
    
    <SpecifiedLogisticsTransportMovement>
      <StageCode>Main-Carriage</StageCode>
      <ModeCode>4</ModeCode>
      <ID>XX345</ID>
      <SequenceNumeric>2</SequenceNumeric>
      <DepartureEvent>
        <ScheduledOccurrenceDateTime>2021-03-12</ScheduledOccurrenceDateTime>
        <OccurrenceArrivalLocation>
          <ID>DUB</ID>
          <Name>Dublin</Name>
        </OccurrenceArrivalLocation>
      </DepartureEvent>
      <ArrivalEvent>
        <OccurrenceArrivalLocation>
          <ID>AUH</ID>
          <Name>Abu Dhabi</Name>
        </OccurrenceArrivalLocation>
      </ArrivalEvent>
    </SpecifiedLogisticsTransportMovement>
    
    <!-- Rates and Charges -->
    <ApplicableRating>
      <TotalChargeAmount currencyID="EUR">4626.48</TotalChargeAmount>
      <ConsignmentItemQuantity>1</ConsignmentItemQuantity>
      <IncludedRatedShipment>
        <TypeCode>M</TypeCode>
        <ApplicableRating>
          <ChargeableWeightMeasure unitCode="KGM">1042</ChargeableWeightMeasure>
          <AppliedRate>4.44</AppliedRate>
          <TotalChargeAmount currencyID="EUR">4626.48</TotalChargeAmount>
        </ApplicableRating>
        <GoodsDescription>CONSOLIDATION
AS PER ATTACHED
MANIFEST
SECURE CARGO</GoodsDescription>
        <TariffClassCode>M</TariffClassCode>
        <PieceQuantity>3</PieceQuantity>
        <GrossWeightMeasure unitCode="KGM">1042</GrossWeightMeasure>
      </IncludedRatedShipment>
    </ApplicableRating>
    
    <!-- Special Handling -->
    <HandlingInstructions>
      <DescriptionCode>GEN</DescriptionCode>
    </HandlingInstructions>
    
    <!-- OCI (Other Customs Information) -->
    <IncludedCustomsNote>
      <CountryID>IE</CountryID>
      <SubjectCode>SHP</SubjectCode>
      <ContentCode>T</ContentCode>
      <Content>IE1234567N</Content>
    </IncludedCustomsNote>
    
    <!-- Signature / Execution -->
    <SignatoryCarrierAuthentication>
      <Signatory>MARK USER</Signatory>
      <ActualDateTime>2021-03-10</ActualDateTime>
      <IssueAuthenticationLocation>
        <Name>ORK</Name>
      </IssueAuthenticationLocation>
    </SignatoryCarrierAuthentication>
    
  </MasterConsignment>
  
</iata:XFWB>
