<?xml version="1.0" encoding="UTF-8"?>
<!--
  EJEMPLO DE REFERENCIA: XFWB Formato Riege/IATA Completo
  
  Este archivo representa la estructura exacta que genera DescartesXmlService
  siguiendo el estándar IATA Cargo-XML 3.0 y los ejemplos de Riege one-record-converter.
  
  CARACTERÍSTICAS CLAVE:
  - Namespace default: iata:datamodel:3
  - Namespace ns2: iata:waybill:1 (para elementos del mensaje)
  - Prefijo ns2: en elementos principales (Waybill, MessageHeaderDocument, etc.)
  - SenderParty dual: schemeID="C" (Company) + schemeID="P" (PIMA address)
  - IssueAuthenticationLocation en SignatoryCarrierAuthentication
  - ApplicableTotalRating con ApplicablePrepaidCollectMonetarySummation
  - TypeCode: 740=Direct, 741=Master (consolidación)
-->
<ns2:Waybill xmlns="iata:datamodel:3" 
             xmlns:ns2="iata:waybill:1"
             xmlns:ns3="urn:un:unece:uncefact:codelist:standard:UNECE:PartyRoleCode:D09A"
             xmlns:ns4="urn:un:unece:uncefact:codelist:standard:IANA:CharacterSetCode:2007-05-14"
             xmlns:ns5="urn:un:unece:uncefact:codelist:standard:UNECE:TransportModeCode:2"
             xmlns:ns6="urn:un:unece:uncefact:codelist:standard:IANA:MIMEMediaType:2009-09-01"
             xmlns:ns7="urn:un:unece:uncefact:codelist:standard:6:0133:40106"
             xmlns:ns8="urn:un:unece:uncefact:codelist:standard:6:Recommendation20:6"
             xmlns:ns9="urn:un:unece:uncefact:codelist:standard:UNECE:DocumentNameCode:D09A"
             xmlns:ns10="urn:un:unece:uncefact:codelist:standard:6:3055:D09A"
             xmlns:ns11="urn:un:unece:uncefact:identifierlist:standard:5:ISO316612A:SecondEdition2006VI-6"
             xmlns:ns12="urn:un:unece:uncefact:codelist:standard:5:ISO42173A:2009-09-09">

  <!-- Message Header -->
  <ns2:MessageHeaderDocument>
    <ID>888-11111111_abc123-uuid-here</ID>
    <Name>Master Air Waybill</Name>
    <!-- 741 = Master AWB (Consolidation) -->
    <TypeCode>741</TypeCode>
    <IssueDateTime>2021-03-10T10:00:00</IssueDateTime>
    <PurposeCode>Creation</PurposeCode>
    <VersionID>3.00</VersionID>
    <!-- SenderParty con schemeID="C" (Company Code) -->
    <SenderParty>
      <PrimaryID schemeID="C">CARGOSYSTEM</PrimaryID>
    </SenderParty>
    <!-- SenderParty con schemeID="P" (PIMA Address) -->
    <SenderParty>
      <PrimaryID schemeID="P">REUFFW90AVTOPF/BOG01</PrimaryID>
    </SenderParty>
    <RecipientParty>
      <PrimaryID schemeID="C">USCAIR01LUXXSXS</PrimaryID>
    </RecipientParty>
  </ns2:MessageHeaderDocument>

  <!-- Business Header -->
  <ns2:BusinessHeaderDocument>
    <ID>888-11111111</ID>
    <IncludedHeaderNote>
      <!-- C = Consolidation (tiene houses) -->
      <ContentCode>C</ContentCode>
      <Content>Consolidation Shipment</Content>
    </IncludedHeaderNote>
    <SignatoryCarrierAuthentication>
      <ActualDateTime>2021-03-10</ActualDateTime>
      <Signatory>MARK USER</Signatory>
      <IssueAuthenticationLocation>
        <Name>ORK</Name>
      </IssueAuthenticationLocation>
    </SignatoryCarrierAuthentication>
  </ns2:BusinessHeaderDocument>

  <!-- Master Consignment -->
  <ns2:MasterConsignment>
    <ID>11111111</ID>
    
    <!-- Indicadores NVD -->
    <NilCarriageValueIndicator>true</NilCarriageValueIndicator>
    <NilCustomsValueIndicator>true</NilCustomsValueIndicator>
    <NilInsuranceValueIndicator>true</NilInsuranceValueIndicator>
    
    <!-- Indicadores de pago -->
    <TotalChargePrepaidIndicator>true</TotalChargePrepaidIndicator>
    <TotalDisbursementPrepaidIndicator>true</TotalDisbursementPrepaidIndicator>
    
    <!-- Peso y volumen -->
    <IncludedTareGrossWeightMeasure unitCode="KGM">1042.0</IncludedTareGrossWeightMeasure>
    <GrossVolumeMeasure unitCode="MTQ">2.602</GrossVolumeMeasure>
    <TotalPieceQuantity>3</TotalPieceQuantity>
    
    <!-- Consignor (Shipper) -->
    <ConsignorParty>
      <Name>FORWARDER COMPANY IRELAND LTD</Name>
      <PostalStructuredAddress>
        <PostcodeCode>ABCD</PostcodeCode>
        <StreetName>HARBOUR POINT BUSINESS PARK</StreetName>
        <CityName>LITTLE CITY</CityName>
        <CountryID>IE</CountryID>
      </PostalStructuredAddress>
      <DefinedTradeContact>
        <DirectTelephoneCommunication>
          <CompleteNumber>353123456789</CompleteNumber>
        </DirectTelephoneCommunication>
      </DefinedTradeContact>
    </ConsignorParty>
    
    <!-- Consignee -->
    <ConsigneeParty>
      <Name>FORWARDER COMPANY SHANGHAI LTD</Name>
      <PostalStructuredAddress>
        <StreetName>SUHANG RD PUDONG AIRPORT</StreetName>
        <CityName>SHANGHAI</CityName>
        <CountryID>CN</CountryID>
      </PostalStructuredAddress>
      <DefinedTradeContact>
        <DirectTelephoneCommunication>
          <CompleteNumber>861234567890</CompleteNumber>
        </DirectTelephoneCommunication>
      </DefinedTradeContact>
    </ConsigneeParty>
    
    <!-- Freight Forwarder -->
    <FreightForwarderParty>
      <Name>FORWARDER COMPANY IRELAND LIMITED</Name>
      <AccountID>87654321</AccountID>
      <CargoAgentID>3456789</CargoAgentID>
      <FreightForwarderAddress>
        <PostcodeCode>ABCD</PostcodeCode>
        <StreetName>Harbour Point Business Park</StreetName>
        <CityName>Little City</CityName>
        <CountryID>IE</CountryID>
      </FreightForwarderAddress>
      <SpecifiedCargoAgentLocation>
        <ID>0123</ID>
      </SpecifiedCargoAgentLocation>
      <DefinedTradeContact>
        <DirectTelephoneCommunication>
          <CompleteNumber>353987654321</CompleteNumber>
        </DirectTelephoneCommunication>
      </DefinedTradeContact>
    </FreightForwarderParty>
    
    <!-- Origin / Destination -->
    <OriginLocation>
      <ID>ORK</ID>
    </OriginLocation>
    <FinalDestinationLocation>
      <ID>PVG</ID>
    </FinalDestinationLocation>
    
    <!-- Transport Movements (Flights) -->
    <SpecifiedLogisticsTransportMovement>
      <StageCode>Main-Carriage</StageCode>
      <ModeCode>4</ModeCode>
      <Mode>Air transport</Mode>
      <ID>XX8012</ID>
      <SequenceNumeric>1</SequenceNumeric>
      <UsedLogisticsTransportMeans>
        <Name>XX</Name>
      </UsedLogisticsTransportMeans>
      <ArrivalEvent>
        <OccurrenceArrivalLocation>
          <ID>DUB</ID>
          <TypeCode>Airport</TypeCode>
        </OccurrenceArrivalLocation>
      </ArrivalEvent>
      <DepartureEvent>
        <ScheduledOccurrenceDateTime>2021-03-10T00:00:00</ScheduledOccurrenceDateTime>
        <OccurrenceDepartureLocation>
          <ID>ORK</ID>
          <TypeCode>Airport</TypeCode>
        </OccurrenceDepartureLocation>
      </DepartureEvent>
    </SpecifiedLogisticsTransportMovement>
    
    <!-- Special Handling Instructions -->
    <HandlingSPHInstructions>
      <DescriptionCode>NSC</DescriptionCode>
    </HandlingSPHInstructions>
    
    <!-- Other Service Instructions -->
    <HandlingOSIInstructions>
      <Description>HANDLE WITH CARE</Description>
    </HandlingOSIInstructions>
    
    <!-- Customs Notes (OCI) -->
    <IncludedCustomsNote>
      <ContentCode>T</ContentCode>
      <Content>IE1234567N</Content>
      <SubjectCode>SHP</SubjectCode>
      <CountryID>IE</CountryID>
    </IncludedCustomsNote>
    
    <!-- Customs Procedure -->
    <AssociatedConsignmentCustomsProcedure>
      <GoodsStatusCode>X</GoodsStatusCode>
    </AssociatedConsignmentCustomsProcedure>
    
    <!-- Currency -->
    <ApplicableOriginCurrencyExchange>
      <SourceCurrencyCode>EUR</SourceCurrencyCode>
    </ApplicableOriginCurrencyExchange>
    
    <!-- Other Charges -->
    <ApplicableLogisticsAllowanceCharge>
      <ID>MC</ID>
      <PrepaidIndicator>true</PrepaidIndicator>
      <PartyTypeCode>C</PartyTypeCode>
      <ActualAmount currencyID="EUR">1234.56</ActualAmount>
    </ApplicableLogisticsAllowanceCharge>
    
    <!-- Applicable Rating -->
    <ApplicableRating>
      <TypeCode>F</TypeCode>
      <ConsignmentItemQuantity>1</ConsignmentItemQuantity>
      <IncludedMasterConsignmentItem>
        <SequenceNumeric>1</SequenceNumeric>
        <TypeCode>000111</TypeCode>
        <GrossWeightMeasure unitCode="KGM">1042.0</GrossWeightMeasure>
        <GrossVolumeMeasure unitCode="CMQ">2602000</GrossVolumeMeasure>
        <PieceQuantity>3</PieceQuantity>
        <NatureIdentificationTransportCargo>
          <Identification>CONSOLIDATION AS PER ATTACHED DOCUMENTS</Identification>
        </NatureIdentificationTransportCargo>
        <AssociatedUnitLoadTransportEquipment>
          <ID>1337</ID>
          <CharacteristicCode>PMC</CharacteristicCode>
          <OperatingParty>
            <PrimaryID>XX</PrimaryID>
          </OperatingParty>
        </AssociatedUnitLoadTransportEquipment>
        <TransportLogisticsPackage>
          <ItemQuantity>2</ItemQuantity>
          <LinearSpatialDimension>
            <WidthMeasure unitCode="CMT">80</WidthMeasure>
            <LengthMeasure unitCode="CMT">120</LengthMeasure>
            <HeightMeasure unitCode="CMT">96</HeightMeasure>
          </LinearSpatialDimension>
        </TransportLogisticsPackage>
        <ApplicableFreightRateServiceCharge>
          <CategoryCode>Q</CategoryCode>
          <ChargeableWeightMeasure unitCode="KGM">1042.0</ChargeableWeightMeasure>
          <AppliedRate>4.44</AppliedRate>
          <AppliedAmount currencyID="EUR">4626.48</AppliedAmount>
        </ApplicableFreightRateServiceCharge>
      </IncludedMasterConsignmentItem>
    </ApplicableRating>
    
    <!-- CRITICAL: ApplicableTotalRating con estructura correcta -->
    <ApplicableTotalRating>
      <TypeCode>F</TypeCode>
      <ApplicablePrepaidCollectMonetarySummation>
        <PrepaidIndicator>true</PrepaidIndicator>
        <WeightChargeTotalAmount currencyID="EUR">4626.48</WeightChargeTotalAmount>
        <TaxTotalAmount currencyID="EUR">11.22</TaxTotalAmount>
        <CarrierTotalDuePayableAmount currencyID="EUR">4637.70</CarrierTotalDuePayableAmount>
        <GrandTotalAmount currencyID="EUR">4637.70</GrandTotalAmount>
      </ApplicablePrepaidCollectMonetarySummation>
    </ApplicableTotalRating>
    
  </ns2:MasterConsignment>
</ns2:Waybill>
